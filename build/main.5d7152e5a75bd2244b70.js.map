{"version":3,"sources":["webpack:///./js/notify.js","webpack:///./js/apiService.js","webpack:///./js/references.js","webpack:///./js/render.js","webpack:///./js/modal.js","webpack:///./js/main.js","webpack:///./templates/image-item.hbs"],"names":["options","resetPage","this","fetch","url","response","json","jsonData","totalHits","hits","length","page","pagination","query","encodeURIComponent","gallery","document","querySelector","form","require","error","success","messages","text","title","styling","icons","animation","animateSpeed","showSuccess","opt","shift","type","delay","sticker","maxTextHeight","showError","message","width","pageObserver","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","unobserve","target","pixabayService","then","data","renderHtmlMarkup","catch","notify","rootMargin","refs","insertAdjacentHTML","imageTpl","isLastPage","observe","lastElementChild","ModalGalleryForm","close","overlay","elm","addEventListener","hideEvent","bind","openEvent","event","preventDefault","targetEl","nodeName","modal","classList","add","dataset","source","alt","window","keyEvent","remove","removeEventListener","key","image","src","innerHTML","currentTarget","search","elements","value","trim","reset","Handlebars","module","exports","template","container","depth0","helpers","partials","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","nullContext","program","noop"],"mappings":"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","file":"main.5d7152e5a75bd2244b70.js","sourcesContent":["import '@pnotify/core/dist/PNotify.css';\nimport '@pnotify/core/dist/BrightTheme.css';\n\nconst { error, success } = require('@pnotify/core');\n\n\nconst messages = function () {\n  const options = {\n    text: '',\n    title: '',\n    styling: 'brighttheme',\n    icons: 'brighttheme',\n    animation: 'fade',\n    animateSpeed: 'slow',\n  };\n  return {\n    showSuccess(page, pagination, opt = {}) {\n      const shift = (page - 2) * pagination;\n      success({\n        ...options, ...{\n          type: 'success',\n          title: `Fetched data: page # ${page - 1}`,\n          text: `Render images: ${1 + shift} - ${shift + pagination} \\n\\n`,\n          delay: 500,\n          sticker: false,\n          maxTextHeight: null,\n        }\n      });\n    },\n    showError(message) {\n      error({\n        ...options, ...{\n          type: 'error',\n          title: `Error fetching data`,\n          text: `Message ${message}`,\n          delay: 3000,\n          width: '350px',\n          sticker: false,\n          maxTextHeight: null,\n        }\n      });\n    }\n  }\n}\n\n\n\nexport default messages();","class PixabayImagesAPI {\n  #searchQuery = '';\n  #page = 1;\n  #pagination = 12;\n  #key = '21129033-533ef8f2fd9810bb53beb1a5f';\n  #lastPage\n  constructor() { }\n\n\n\n  get page() {\n    return this.#page;\n  }\n  set page(page) {\n    this.#page = page;\n  }\n\n  get isLastPage() {\n    return this.#lastPage;\n  }\n\n\n  get pagination() {\n    return this.#pagination;\n  }\n  set pagination(pagination) {\n    this.#pagination = pagination;\n  }\n\n  get query() {\n    return this.#searchQuery;\n  }\n  set query(query) {\n    this.#searchQuery = encodeURIComponent(query);\n  }\n\n  resetPage() {\n    this.#page = 1;\n  }\n\n  async fetch() {\n    const url = `https://pixabay.com/api/?image_type=photo&orientation=horizontal&q=${this.#searchQuery}&page=${this.#page}&per_page=${this.#pagination}&key=${this.#key}`;\n    try {\n      const response = await fetch(url);\n      const jsonData = await response.json();\n      this.#page += 1;\n      const { totalHits, hits } = jsonData\n      this.#lastPage = !((hits.length) && ((this.#page - 1) * this.#pagination < totalHits))\n      return jsonData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\n// fetch() {\n//   const url = `https://pixabay.com/api/?image_type=photo&orientation=horizontal&q=${this._searchQuery}&page=${this._page}&per_page=${this._pagination}&key=${this._key}`;\n//   return fetch(url)\n//     .then(response => response.json())\n//     .then(response => {\n//       this._page += 1;\n//       return response;\n//     })\n// }\n\nexport default new PixabayImagesAPI();\n","const gallery = document.querySelector('.js-gallery');\nconst form = document.querySelector('#search-form');\n\nexport default {\n  gallery,\n  form,\n};\n","import imageTpl from '../templates/image-item.hbs';\nimport refs from './references.js';\nimport pixabayService from './apiService.js';\nimport notify from './notify.js';\n\nconst pageObserver = new IntersectionObserver(\n  (entries, observer) => {\n    entries.forEach(entry => {\n      if (entry.isIntersecting) {\n        observer.unobserve(entry.target);\n        pixabayService\n          .fetch()\n          .then(data => renderHtmlMarkup(data))\n          .catch(message => notify.showError(message));\n      }\n    });\n  },\n  {\n    rootMargin: '-10px',\n  },\n);\n\nfunction renderHtmlMarkup({ hits }) {\n  refs.gallery.insertAdjacentHTML('beforeend', imageTpl(hits));\n  notify.showSuccess(pixabayService.page, pixabayService.pagination);\n  if (!pixabayService.isLastPage) {\n    pageObserver.observe(refs.gallery.lastElementChild);\n  }\n}\n\nexport default renderHtmlMarkup;\n","class ModalGalleryForm {\n  constructor() {\n    this.refs = this.#getReference();\n    [this.refs.close, this.refs.overlay].forEach(elm =>\n      elm.addEventListener('click', this.hideEvent.bind(this))\n    );\n  }\n\n  #getReference() {\n    const modal = document.querySelector('.js-lightbox');\n    const overlay = document.querySelector('.js-lightbox .lightbox__overlay');\n    const image = document.querySelector('.js-lightbox .lightbox__image');\n    const close = document.querySelector('button[data-action=\"close-lightbox\"]');\n    return { modal, overlay, image, close, };\n  }\n\n  #initImage(src = '', alt = '') {\n    this.refs.image.src = src;\n    this.refs.image.alt = alt;\n  }\n\n  openEvent(event) {\n    event.preventDefault();\n    const targetEl = event.target;\n    if (targetEl.nodeName === 'IMG') {\n      this.refs.modal.classList.add('is-open');\n      this.#initImage(targetEl.dataset.source, targetEl.alt);\n      window.addEventListener('keydown', this.keyEvent.bind(this));\n    }\n  }\n\n  hideEvent(event) {\n    event.preventDefault();\n    this.refs.modal.classList.remove('is-open');\n    this.#initImage();\n    window.removeEventListener('keydown', this.keyEvent.bind(this));\n  }\n\n  keyEvent(event) {\n    switch (event.key) {\n      case 'Escape':\n        this.hideEvent(event);\n        break;\n    }\n  }\n};\n\n\nexport default new ModalGalleryForm();\n","import pixabayService from './apiService.js';\nimport refs from './references.js';\nimport renderHtmlMarkup from './render.js';\nimport modal from './modal.js';\nimport notify from './notify.js';\n\n\nrefs.form.addEventListener('submit', submitHandler);\nrefs.gallery.addEventListener('click', modal.openEvent.bind(modal));\n\nfunction clearImageContainer() {\n  refs.gallery.innerHTML = '';\n}\n\nfunction submitHandler(event) {\n  event.preventDefault();\n  clearImageContainer();\n  const form = event.currentTarget;\n  const search = form.elements.query.value.trim();\n  form.reset();\n  if (search) {\n    pixabayService.query = search;\n    pixabayService.resetPage();\n    pixabayService\n      .fetch()\n      .then(data => renderHtmlMarkup(data))\n      .catch(message => notify.showError(message));\n\n  }\n\n}\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<li class=\\\"gallery__item\\\">\\n    <a href=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0), depth0))\n    + \"\\\" class=\\\"gallery__link\\\">\\n        <img class=\\\"gallery__image\\\" src=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" data-source=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0), depth0))\n    + \"\\\"\\n            alt=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"tags\") : depth0), depth0))\n    + \"\\\" />\\n\\n    </a>\\n    <div class=\\\"gallery__stats\\\">\\n        <p class=\\\"gallery__stats-item\\\">\\n            <i class=\\\"material-icons\\\">thumb_up</i>\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"likes\") : depth0), depth0))\n    + \"\\n        </p>\\n        <p class=\\\"gallery__stats-item\\\">\\n            <i class=\\\"material-icons\\\">visibility</i>\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"views\") : depth0), depth0))\n    + \"\\n        </p>\\n        <p class=\\\"gallery__stats-item\\\">\\n            <i class=\\\"material-icons\\\">comment</i>\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"comments\") : depth0), depth0))\n    + \"\\n        </p>\\n        <p class=\\\"gallery__stats-item\\\">\\n            <i class=\\\"material-icons\\\">cloud_download</i>\\n            \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0), depth0))\n    + \"\\n        </p>\\n    </div>\\n</li>\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":27,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});"],"sourceRoot":""}